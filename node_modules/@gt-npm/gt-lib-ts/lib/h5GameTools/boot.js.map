{"version":3,"file":"boot.js","sources":["../../../../packages/h5GameTools/boot.ts"],"sourcesContent":["\nimport { Logger } from '@gtLibTs/logger';\nimport { DetectDevice } from '@gtLibTs/utils/detectDevice';\nimport { getUrlQuery } from '@gtLibTs/utils/urlUtils';\nimport VConsole from 'vconsole';\n\nimport { CommonStore } from '@gtLibTs/h5GameTools/commonStore';\nimport { UrlHelper } from '@gtLibTs/h5GameTools/urlHelper';\n\nfunction addVConsole() {\n    const betaAIO = DetectDevice.isAIO && UrlHelper.shared.domain.includes('game2.casinovir999.net');\n\n    if (getUrlQuery('console') === '1' || betaAIO) {\n        const vConsole = new VConsole();\n\n        if (betaAIO) {\n            let count = 0;\n            let timer = 0;\n\n            const toggleTarget = {\n                _status: false,\n                get status() {\n                    return this._status;\n                },\n                set status(val) {\n                    this._status = val;\n                    val ? vConsole.showSwitch() : vConsole.hideSwitch();\n                },\n                toggle() {\n                    this.status = !this.status;\n                }\n            };\n\n            const touchHandler = (e: TouchEvent) => {\n                if (e.touches.length !== 4) return;\n\n                timer && clearTimeout(timer);\n\n                if (count++ === 4) {\n                    toggleTarget.toggle();\n                    count = 0;\n                    return;\n                }\n                timer = setTimeout(() => count = 0, 1000) as any;\n            };\n\n            toggleTarget.status = false;\n            document.addEventListener('touchstart', touchHandler);\n        }\n    }\n}\n\nasync function getI18n() {\n    try {\n        const url = `${UrlHelper.shared.domain}/ipl/app/flash/pig/game/common/dict/${UrlHelper.shared.lang}.json?v=${Date.now()}`;\n        const i18n = await (await fetch(url)).json();\n        CommonStore.shared.storeMutation.setData('i18n', i18n);\n    } catch (e) {\n        Logger.error(e);\n    }\n}\n\nexport default async function boot() {\n    if (window.gtLibTsScope?.awaitH5GameToolsReady) return window.gtLibTsScope.awaitH5GameToolsReady;\n    return (window.gtLibTsScope ??= {}).awaitH5GameToolsReady = Promise.all([\n        CommonStore.shared.boot(),\n        getI18n(),\n        addVConsole()\n    ]);\n}"],"names":["DetectDevice","UrlHelper","getUrlQuery","CommonStore","Logger"],"mappings":"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"}