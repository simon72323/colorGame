{"version":3,"file":"aesCrypto.mjs","sources":["../../../../packages/webSocketCore/aesCrypto.ts"],"sourcesContent":["import CryptoJS from 'crypto-js';\n\nexport interface ICrypto {\n    encrypt(data: any): string;\n    decrypt(data: any): string;\n}\n\nexport class AESCrypto implements ICrypto {\n    private key!: CryptoJS.lib.WordArray;\n    private iv!: CryptoJS.lib.WordArray;\n\n    constructor(private secret: string) {\n        this.init();\n    }\n\n    public init(secret?: string) {\n        if (secret) {\n            this.secret = secret;\n        }\n\n        let decodedSecret = atob(this.secret.replace(/-/g, '+').replace(/_/g, '/'));\n        const [key, iv] = decodedSecret.split('.');\n\n        this.iv = CryptoJS.enc.Utf8.parse(iv);\n        this.key = CryptoJS.enc.Utf8.parse(key);\n    }\n\n\n    public encrypt(_data: any) {\n        let data = _data;\n        if (typeof data !== 'string') {\n            data = JSON.stringify(data);\n        }\n\n        const cipherText = CryptoJS.AES.encrypt(data, this.key, {\n            iv: this.iv,\n            mode: CryptoJS.mode.CBC,\n            padding: CryptoJS.pad.Pkcs7\n        });\n\n        return cipherText.toString();\n    }\n\n    public decrypt(data: string) {\n        const plaintext = CryptoJS.AES.decrypt(data, this.key, {\n            mode: CryptoJS.mode.CBC,\n            iv: this.iv,\n            padding: CryptoJS.pad.Pkcs7\n        });\n\n        return plaintext.toString(CryptoJS.enc.Utf8);\n    }\n}"],"names":[],"mappings":";;;;;AAOO,MAAM,SAA6B,CAAA;AAAA,EAItC,YAAoB,MAAgB,EAAA;AAAhB,IAAA,IAAA,CAAA,MAAA,GAAA,MAAA,CAAA;AAHpB,IAAQ,aAAA,CAAA,IAAA,EAAA,KAAA,CAAA,CAAA;AACR,IAAQ,aAAA,CAAA,IAAA,EAAA,IAAA,CAAA,CAAA;AAGJ,IAAA,IAAA,CAAK,IAAK,EAAA,CAAA;AAAA,GACd;AAAA,EAEO,KAAK,MAAiB,EAAA;AACzB,IAAA,IAAI,MAAQ,EAAA;AACR,MAAA,IAAA,CAAK,MAAS,GAAA,MAAA,CAAA;AAAA,KAClB;AAEA,IAAI,IAAA,aAAA,GAAgB,IAAK,CAAA,IAAA,CAAK,MAAO,CAAA,OAAA,CAAQ,IAAM,EAAA,GAAG,CAAE,CAAA,OAAA,CAAQ,IAAM,EAAA,GAAG,CAAC,CAAA,CAAA;AAC1E,IAAA,MAAM,CAAC,GAAK,EAAA,EAAE,CAAI,GAAA,aAAA,CAAc,MAAM,GAAG,CAAA,CAAA;AAEzC,IAAA,IAAA,CAAK,EAAK,GAAA,QAAA,CAAS,GAAI,CAAA,IAAA,CAAK,MAAM,EAAE,CAAA,CAAA;AACpC,IAAA,IAAA,CAAK,GAAM,GAAA,QAAA,CAAS,GAAI,CAAA,IAAA,CAAK,MAAM,GAAG,CAAA,CAAA;AAAA,GAC1C;AAAA,EAGO,QAAQ,KAAY,EAAA;AACvB,IAAA,IAAI,IAAO,GAAA,KAAA,CAAA;AACX,IAAI,IAAA,OAAO,SAAS,QAAU,EAAA;AAC1B,MAAO,IAAA,GAAA,IAAA,CAAK,UAAU,IAAI,CAAA,CAAA;AAAA,KAC9B;AAEA,IAAA,MAAM,aAAa,QAAS,CAAA,GAAA,CAAI,OAAQ,CAAA,IAAA,EAAM,KAAK,GAAK,EAAA;AAAA,MACpD,IAAI,IAAK,CAAA,EAAA;AAAA,MACT,IAAA,EAAM,SAAS,IAAK,CAAA,GAAA;AAAA,MACpB,OAAA,EAAS,SAAS,GAAI,CAAA,KAAA;AAAA,KACzB,CAAA,CAAA;AAED,IAAA,OAAO,WAAW,QAAS,EAAA,CAAA;AAAA,GAC/B;AAAA,EAEO,QAAQ,IAAc,EAAA;AACzB,IAAA,MAAM,YAAY,QAAS,CAAA,GAAA,CAAI,OAAQ,CAAA,IAAA,EAAM,KAAK,GAAK,EAAA;AAAA,MACnD,IAAA,EAAM,SAAS,IAAK,CAAA,GAAA;AAAA,MACpB,IAAI,IAAK,CAAA,EAAA;AAAA,MACT,OAAA,EAAS,SAAS,GAAI,CAAA,KAAA;AAAA,KACzB,CAAA,CAAA;AAED,IAAA,OAAO,SAAU,CAAA,QAAA,CAAS,QAAS,CAAA,GAAA,CAAI,IAAI,CAAA,CAAA;AAAA,GAC/C;AACJ;;;;"}