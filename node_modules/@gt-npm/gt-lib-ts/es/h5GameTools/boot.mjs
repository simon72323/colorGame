import { Logger } from '../logger/index.mjs';
import { DetectDevice } from '../utils/detectDevice.mjs';
import { getUrlQuery } from '../utils/urlUtils.mjs';
import VConsole from 'vconsole';
import { CommonStore } from './commonStore/index.mjs';
import { UrlHelper } from './urlHelper.mjs';

function addVConsole() {
  const betaAIO = DetectDevice.isAIO && UrlHelper.shared.domain.includes("game2.casinovir999.net");
  if (getUrlQuery("console") === "1" || betaAIO) {
    const vConsole = new VConsole();
    if (betaAIO) {
      let count = 0;
      let timer = 0;
      const toggleTarget = {
        _status: false,
        get status() {
          return this._status;
        },
        set status(val) {
          this._status = val;
          val ? vConsole.showSwitch() : vConsole.hideSwitch();
        },
        toggle() {
          this.status = !this.status;
        }
      };
      const touchHandler = (e) => {
        if (e.touches.length !== 4) return;
        timer && clearTimeout(timer);
        if (count++ === 4) {
          toggleTarget.toggle();
          count = 0;
          return;
        }
        timer = setTimeout(() => count = 0, 1e3);
      };
      toggleTarget.status = false;
      document.addEventListener("touchstart", touchHandler);
    }
  }
}
async function getI18n() {
  try {
    const url = `${UrlHelper.shared.domain}/ipl/app/flash/pig/game/common/dict/${UrlHelper.shared.lang}.json?v=${Date.now()}`;
    const i18n = await (await fetch(url)).json();
    CommonStore.shared.storeMutation.setData("i18n", i18n);
  } catch (e) {
    Logger.error(e);
  }
}
async function boot() {
  var _a, _b;
  if ((_a = window.gtLibTsScope) == null ? void 0 : _a.awaitH5GameToolsReady) return window.gtLibTsScope.awaitH5GameToolsReady;
  return ((_b = window.gtLibTsScope) != null ? _b : window.gtLibTsScope = {}).awaitH5GameToolsReady = Promise.all([
    CommonStore.shared.boot(),
    getI18n(),
    addVConsole()
  ]);
}

export { boot as default };
//# sourceMappingURL=boot.mjs.map
